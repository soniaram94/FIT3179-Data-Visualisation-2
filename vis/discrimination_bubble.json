{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Sources of discrimination â€” bubble chart.",
  
  "width": 250,
  "height": 220,
  "padding": { "top": 8, "right": 10, "bottom": 24, "left": 10 },
  
  "data": {
    "url": "https://raw.githubusercontent.com/soniaram94/FIT3179-Data-Visualisation-2/main/data/discrimination_sources.csv",
    "format": {
      "type": "csv",
      "parse": {
        "severe_pct": "number",
        "other_pct":  "number",
        "all_pct":    "number"
      }
    }
  },
  
  "transform": [
    { "fold": ["severe_pct","other_pct","all_pct"], "as": ["group_key","pct_num"] },
    {
      "calculate": "datum.group_key === 'severe_pct' ? 'Severe/Profound' : (datum.group_key === 'other_pct' ? 'Other status' : 'All with disability')",
      "as": "group"
    }
  ],
  
  "mark": { "type": "circle", "opacity": 0.75 },
  
  "encoding": {
    "x": {
      "field": "source", "type": "nominal",
      "axis": { 
        "title": "Source of discrimination", 
        "labelAngle": -45, 
        "labelLimit": 150,
        "labelFontSize": 10, 
        "titleFontSize": 11 
      }
    },
    "y": {
      "field": "group", "type": "nominal",
      "sort": ["Severe/Profound", "Other status", "All with disability"],
      "axis": { 
        "title": "Disability severity group", 
        "labelFontSize": 10, 
        "titleFontSize": 11 
      }
    },
    "size": {
      "field": "pct_num", "type": "quantitative", "title": "Percent (%)",
      "scale": { "range": [60, 1200] },
      "legend": { 
        "orient": "right", 
        "direction": "vertical", 
        "labelFontSize": 10, 
        "titleFontSize": 11 
      }
    },
    "color": {
      "field": "group", "type": "nominal", "title": "Group",
      "scale": { "range": ["#18aad6", "#1c9984", "#3eab52"] },
      "legend": { 
        "orient": "right", 
        "direction": "vertical", 
        "labelFontSize": 10, 
        "titleFontSize": 11 
      }
    },
    "tooltip": [
      { "field": "source", "title": "Source" },
      { "field": "group", "title": "Group" },
      { "field": "pct_num", "title": "Percent (%)", "format": ".1f" }
    ]
  },
  
  "config": {
    "view": { "stroke": null }
  }
}